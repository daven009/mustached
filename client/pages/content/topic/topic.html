<template name="topic">
  <style>
    .markdown-content {
      width:100%;
      overflow-x: hidden;
    }
    .nano .nano-pane   { background: transparent; }
    .nano .nano-slider { background: #1E3E46; }
  </style>
  <aside class="bg-light lter">
    {{#with topic}}
    <section id="chat-app">
      <div class="wrapper b-b topic-header" id="chat-header">
        <div class="clearfix">
          <div class="col-xs-10 no-padder">
            <a href="#" class="pull-left thumb m-r">
              <img src="{{getUserAvatarByUserId creator 64}}" class="img-rounded">
            </a>
            <div class="clear">
              <div class="h3 m-t-xs m-b-xs">{{title}}</div>
              <small class="text-muted">{{getUsernameByUserId creator}} · {{momentDatetime createdAt}} · <a href="{{pathFor 'nodesList' category=category node=node}}">{{{getFullNodeName category node}}}</a> · 3639 次点击</small>
            </div>
          </div>
          <div class="col-xs-2 no-padder" style="height: 64px;display: table;">
            {{#if markdown content}}
            <div style="vertical-align: middle;display: table-cell;">
              <i class="fa fa-file-text-o fa-2x pointer text-muted hover-darken tool-tip" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="查看原文" id="showContent"></i>
              <i class="fa fa-comment-o fa-2x pointer text-muted hover-darken tool-tip" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="查看留言" id="showMessage" style="display:none"></i>
            </div>
            {{/if}}
          </div>
        </div>
      </div>
      <section class="bg-white-only trpContentPanel" id="contentArea" style="display:none">
        {{#if markdown content}}
        <div class="markdown-body markdown-content content-scrollable" >
          <div class="wrapper" style="padding-top:{{paddingTop}}px !important">
            {{{markdown content}}}
          </div>
        </div>
        {{/if}}
      </section>
      <section class="bg-white-only trpContentPanel nano" id="messageArea">
        <div class="nano-content">
          <ul class="list-group alt no-padder m-b-xs" style="padding-top:{{paddingTop}}px !important">
            {{#each conversations}}
            {{#if hasParent}}
            <li class="list-group-item no-borders no-radius padder-lg" style="padding-top:0px;padding-bottom:0px;">
              <div class="media padder">
                <div class="media-body" style="margin-left: 46px;">
                  <div class="m-b-xxs markdown-body">{{{markdown content}}}</div>
                </div>
              </div>
            </li>
            {{else}}
            <li class="list-group-item no-borders no-radius padder-lg" style="padding-top:15px;padding-bottom:0px;">
              <div class="media padder">
                <span class="pull-left thumb-sm"><img src="{{getUserAvatarByUserId creator 36}}" data-original-title="@{{getUsernameByUserId creator}}" class="img-rounded pointer quote"></span>
                <div class="media-body">
                  <div>
                    <small class="text-muted pointer">{{getUsernameByUserId creator}}
                      {{#if isAuthor creator}}
                      <span class="chat-time">
                        <span>
                          <span class="text-danger"><strong>楼主</strong></span>
                        </span>
                      </span>
                      {{/if}}
                      <span class="chat-time">
                        <span>
                          <span title="" data-original-title="{{momentDatetime createdAt 'MMMM Do YYYY, h:mm:ss a'}}" class="pointer quote">{{momentDatetime createdAt 'MMMM Do YYYY, h:mm:ss a'}}</span>
                        </span>
                      </span>
                    </small>
                  </div>
                  <div class="m-b-xxs markdown-body">{{{markdown content}}}</div>
                </div>
              </div>
            </li>
            {{/if}}
            {{/each}}
          </ul>
        </div>
      </section>
      {{#if currentUser}}
      <footer class="footer b-t bg-white-only no-padder" id="inputArea">
        <li class="list-group-item no-borders padder-lg">
          <div class="media padder">
            <span class="pull-left thumb-sm"><img src="{{getCurrentUserAvatar 36}}" class="img-rounded"></span>
            <div class="pull-right text-mute m-t-sm hover-darken pointer">
              <i class="fa fa-pencil-square-o fa-2x tool-tip" id="composeSwitch" data-toggle="tooltip" data-placement="top" title="" data-original-title="写作模式"></i>
            </div>
            <div class="media-body">
              <div>
                <textarea class="chat-input-text-area" name="chat" id="chat-input-textarea" placeholder="点击此处并输入留言. 支持GitHub flavoured markdown语言." autofocus="" onfocus="this.value = this.value;" maxlength="4096"></textarea>
              </div>
            </div>
          </div>
        </li>
      </footer>
      {{/if}}
    </section>
    {{/with}}
  </aside>
  <aside class="aside-xl">
    <section class="vbox bg-light lter">
      <div class="wrapper b-b">
        <center>
          <div class="form-group m-b-none">
            <div class="input-group">
              <input type="text" class="form-control input-sm no-border bg-dark" placeholder="搜索对话">
              <span class="input-group-btn">
                <button type="submit" class="btn btn-sm btn-success btn-icon"><i class="fa fa-search"></i></button>
              </span>
            </div>
          </div>
        </center>
      </div>
      <div class="no-radius no-borders wrapper">
        {{#each participants}}
        <div class="pull-left m-r-xs pointer">
          <img src="{{getUserAvatarByUserId this 30}}" class="img-rounded">
        </div>
        {{/each}}
      </div>
      <footer class="footer text-center b-t" style="height:65px;">

      </footer>
    </section>
  </aside>
</template>